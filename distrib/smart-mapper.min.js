'use strict';var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};/**
 * @license
 * smart-mapper  0.9.0
 * Copyright Sylvain Longepee
 * Released under MIT license
 */;(function(moduleName,root,factory){if(typeof define==='function'&&define.amd){define(["passthrough-object"],factory);}else if((typeof exports==='undefined'?'undefined':_typeof(exports))==='object'){var Path=require("passthrough-object");module.exports=factory(Path);}else{window.SmartMapper=factory(root.Path);}})("SmartMapperModule",undefined,function(Path){'use strict';var SmartMapper={};function isObject(anything){return anything!==null&&(typeof anything==='undefined'?'undefined':_typeof(anything))==="object";}function mappingObject(compiles,item,array,index){var target={};var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=compiles[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var compile=_step.value;var value=Path.get(item,compile.relateTo,null);if(compile.operate&&value!=null){value=compile.operate.execute(value,item,array,index);}if(value!=null){if(compile.operate&&compile.operate.postCondition){if(compile.operate.postCondition(value)===true){target[compile.key]=value;}}else{target[compile.key]=value;}}}}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return();}}finally{if(_didIteratorError){throw _iteratorError;}}}return target;}function compile(template){var compiles=[];for(var key in template.mappings){var compile={key:key,relateTo:template.mappings[key],operate:template.rules!=null?template.rules.find(function(x){return x.on===key;}):null};compiles.push(compile);}return compiles;}SmartMapper.mapping=function(template,data){var validate=template.validate||function(x){return true;};var childrenPropertyName=template.childrenPropertyName||"childs";var compiles=compile(template);if(Array.isArray(data)){var target=[];for(var i=0;i<data.length;i++){var m=mappingObject(compiles,data[i],data,i);if(template.childrens){var childrens=template.childrens(m);if(childrens){m[childrenPropertyName]=SmartMapper.mapping(template,childrens);}}if(m!=null&&validate(m)){target.push(m);}}return target;}return mappingObject(compiles,data,data,-1);};return SmartMapper;});